<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <title>RSVP</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1 {
            font-size: 4em;
        }

        p {
            font-size: 1.5em;
        }

        #familyMembers {
            margin: 20px 0;
        }

        .checkbox-group div {
            margin-bottom: 10px;
        }

        button {
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        .search {
            padding: 20px;
        }

        /* Style for family names list */
        .family-list div {
            padding: 8px;
            margin-bottom: 10px;
            background-color: #f4f4f4;
            border-radius: 5px;
            cursor: pointer;
        }

        .family-list div:hover {
            background-color: #ddd;
        }

    </style>
</head>
<body>

    <header>
        <a href="home.html">Home</a>
        <a href="rsvp.html">RSVP</a>
        <a href="registry.html">Registry</a>
        <a href="funds.html">Honeymoon Fund</a>
        <a href="faq.html">FAQs</a>
    </header>
    <main>
        <h1>RSVP</h1>
        <p class="main">Please fill out the form to RSVP to the wedding! The invitation included the names
            of those invited and whether or not plus ones were being accomodated! Thank you
            for understanding this is going to be a small wedding and not all can be invited!</p>
        <p class="deadline">The deadline to RSVP is April 20th.</p>

        <label for="search">Search for a family:</label>
        <input type="text" id="search" placeholder="Start typing a name..." />

        <!-- Family search result -->
        <div id="familyList" class="family-list">
            <!-- Matching families will be displayed here -->
        </div>

        <!-- Family members checkboxes -->
        <div id="familyMembersContainer" class="checkbox-group">
            <!-- Checkboxes will appear here dynamically when a family is selected -->
        </div>
    </main>

    <script>
        // Replace with the URL of your deployed Google Apps Script Web App
        const scriptUrl = 'https://script.google.com/macros/s/YOUR_DEPLOYED_URL/exec'; 

        // Fetch family data from the Google Apps Script web app
        fetch(scriptUrl)
            .then(response => response.json())
            .then(families => {
                window.familiesData = families;  // Store the family data globally
            })
            .catch(error => {
                console.error('Error fetching family data:', error);
            });

        // Event listener for the search input field
        document.getElementById('search').addEventListener('input', function(event) {
            const searchTerm = event.target.value.toLowerCase();  // Get the typed input, case insensitive
            const familyList = document.getElementById('familyList');
            familyList.innerHTML = ''; // Clear existing family list

            // Filter families based on the search term
            const filteredFamilies = window.familiesData.filter(family => {
                return family.familyName.toLowerCase().includes(searchTerm);
            });

            // If families are found, display them
            if (filteredFamilies.length > 0) {
                filteredFamilies.forEach(family => {
                    const familyDiv = document.createElement('div');
                    familyDiv.textContent = family.familyName;
                    familyDiv.classList.add('family-name');
                    familyDiv.addEventListener('click', () => displayFamilyMembers(family));
                    familyList.appendChild(familyDiv);
                });
            } else {
                const noMatchDiv = document.createElement('div');
                noMatchDiv.textContent = 'No families found';
                familyList.appendChild(noMatchDiv);
            }
        });

        // Function to display checkboxes for family members
        function displayFamilyMembers(family) {
            const familyMembersContainer = document.getElementById('familyMembersContainer');
            familyMembersContainer.innerHTML = ''; // Clear any existing checkboxes

            family.members.forEach(member => {
                const checkboxContainer = document.createElement('div');
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = member;
                checkbox.value = member;

                const label = document.createElement('label');
                label.setAttribute('for', member);
                label.textContent = member;

                checkboxContainer.appendChild(checkbox);
                checkboxContainer.appendChild(label);
                familyMembersContainer.appendChild(checkboxContainer);
            });
        }
    </script>
</body>
</html>
